[["index.html", " R   Excel                 ", "  R   Excel   2021-05-27             ,    ,      .              .         R   Excel.         R,             .       ,      -   Excel,       ,        .       tidyverse,     : readr, vroom, dplyr, tidyr, ggplot2.   R        ,  data.table,   tidyverse  ,      ,   ,     R    tidyverse.        ,      .    R,   Python? ,  R  ,  Excel    , ..      - .      .            .       ,           .     -           .         ,      .    ,      Microsoft Excel        .  ,     Microsoft Excel         .         , ..    . ,    4         R, ..      dplyr  tidyr    .            ,     ,             . ,          .      ,  2008     .             - Netpeak.     R  : ryandexdirect, rfacebookstat, timeperiodsR, rvkstat   .       R  -.    Telegram  YouTube  R4marketing.       .       ,     Netpeak Journal.          ,   , GoAnalytics, Analyze, eCommerce, 8P  .   2016      R     .        .    R  RStudio    R    R  ,    ,                   R       R    JSON   R        ,  ggplot2   qplot()    R      ggplot2         ggplot2  ,      ,                     .    :            proglib    YouTube "],["-r-rstudio.html", " 1  R  RStudio 1.1  1.2  1.3 ", "  1  R  RStudio 1.1           :  R (Windows)  R (MacOS)   RStudio 1.2  1.3  "],["-r-.html", " 2     R      2.1  2.2  2.3  2.4  2.5 ", "  2     R      2.1             R     Excel.     : 1.  2.  ( ) 3.  2.2  2.3          . 2.4  #  x &lt;- 1 #  y &lt;- 1:10 typeof(y) strings &lt;- c(&quot;string&quot;, &quot;vector&quot;) typeof(strings) vec &lt;- c(3, &quot;string&quot;) typeof(vec) #     strings[1] strings[2] y[3:6] y[c(2, 5, 9)] # , data frame df1 &lt;- data.frame(a = 1:3, b = c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)) #      df1$a df1[&#39;a&#39;] #  typeof(df1) class(df1) list1 &lt;- list(y, strings, vec, df1) list2 &lt;- list(node1 = c(1, 5, 8), node2 = list(&quot;y&quot;, 3, &quot;p&quot;)) #   str(df1) str(list2) str(vec) 2.5  "],["-tsv-csv-excel-google-.html", " 3    TSV, CSV, Excel   Google  3.1  3.2  3.3  3.4  3.5 ", "  3    TSV, CSV, Excel   Google  3.1               R.     csv, tsv, Excel   Google .    R  : vroom, readxl, googlesheets4 3.2  3.3          . ga_december.csv ga_nowember.csv ga_examples.xlsx 3.4  #    R #   install.packages(&quot;vroom&quot;) install.packages(&quot;readxl&quot;) install.packages(&quot;devtools&quot;) devtools::install_github(&quot;tidyverse/googlesheets4&quot;) # ########################################### #   library(&quot;vroom&quot;) # ########################################### #  CSV, TSV     ##    ga_data &lt;- vroom(file = &quot;D:/materials/lesson_3/ga_nowember.csv&quot;, delim = &quot;/t&quot;) ##      ga_data_i &lt;- vroom(&quot;https://raw.githubusercontent.com/selesnow/publications/master/data_example/russian_text_in_r/ga_nowember.csv&quot;) ##       files &lt;- dir(pattern = &quot;\\\\.csv$&quot;) ga_full &lt;- vroom(files) # ########################################### #  Excel  library(readxl) ##     Excel  excel_sheets(&quot;D:/materials/lesson_3/ga_examples.xlsx&quot;) ##     xl_dec &lt;- read_excel(&quot;D:/materials/lesson_3/ga_examples.xlsx&quot;, sheet = &quot;dec&quot;) # ########################################### #  Google  library(googlesheets4) ##  sheets_auth(email = &quot;selesnow@gmail.com&quot;) sheets_find() ##    ss_id &lt;- as_sheets_id(&quot;1xu_beKZVpJJTHTvAab_vN3ZiMB03BytKArGjJUO8cck&quot;) ##     sheets_browse(ss) ##    sheets_sheet_names(ss) ##     gs_ga_data &lt;- sheets_read(ss = ss_id, sheet = &quot;dec&quot;) ##       gs_ga_data &lt;- sheets_read(ss = ss, sheet = &quot;dec&quot;, range = &quot;A1:C10&quot;) 3.5  "],["-dplyr-.html", " 4  dplyr:   ,   ,  ,  4.1  4.2  4.3  4.4  4.5 ", "  4  dplyr:   ,   ,  ,  4.1      dplyr.       ,      .               R  . 4.2  4.3          . 4.4  #   install.packages(&quot;dplyr&quot;) #   library(vroom) library(dplyr) #   ga_data &lt;- vroom(&quot;https://raw.githubusercontent.com/selesnow/publications/master/code_example/from_excel_to_r/lesson_3/ga_nowember.csv&quot;) # ###################################################### # ¤  ##      ga_data_organic &lt;- filter(ga_data, medium == &quot;organic&quot;) ##   ga_data_organic_10 &lt;- filter(ga_data, medium == &quot;organic&quot; &amp; sessions &gt; 10 ) ## ¤      google_yandex &lt;- filter(ga_data, source %in% c(&quot;google&quot;, &quot;yandex&quot;, &quot;bing&quot;)) ##   ¤  search_eng &lt;- c(&quot;google&quot;, &quot;yandex&quot;, &quot;bing&quot;) ##   ¤  not_searcj_eng &lt;- filter(ga_data, ! source %in% search_eng) # ###################################################### #   ##     ¤ ga_data_1 &lt;- select(ga_data, date, sessions) ##    ga_data_2 &lt;- select(ga_data, source:sessions) ##     ¤ ¤ ¤ match_s &lt;- select_at(ga_data, vars(matches(&quot;s&quot;))) #  s match_s2 &lt;- select_at(ga_data, vars(contains(&quot;s&quot;))) #  s last_s1 &lt;- select_at(ga_data, vars(matches(&quot;s$&quot;))) # ¤  s last_s2 &lt;- select_at(ga_data, vars(ends_with(&quot;s&quot;))) # ¤  s start_s1 &lt;- select_at(ga_data, vars(matches(&quot;^s&quot;))) # ¤  s start_s2 &lt;- select_at(ga_data, vars(starts_with(&quot;s&quot;))) # ¤  s ##     ga_num_column &lt;- select_if(ga_data, is.numeric) ga_str_column &lt;- select_if(ga_data, is.character) ##  # select -     # select_at -         ¤  # select_if -    ¤,       ¤ # ###################################################### #   new_ga_data &lt;- rename(ga_data, channel = medium, refferer = source) # ¤    rename_if(ga_data, is.numeric, paste0, &quot;_n&quot;) rename_at(ga_data, vars(matches(&quot;^s&quot;)), paste0, &quot;_s&quot;) rename_all(ga_data, toupper) # ###################################################### #  ##   (  Excel) rename_all(select_if(filter(ga_data, source %in% search_eng), is.numeric), toupper) ##      %&gt;% result &lt;- ga_data %&gt;% filter(source %in% search_eng) %&gt;% select_if(is.numeric) %&gt;% rename_all(toupper) 4.5  "],["-dplyr-mutate-mutate-if-mutate-at-mutate-all.html", " 5  dplyr:    , mutate, mutate_if, mutate_at, mutate_all 5.1  5.2  5.3  5.4  5.5 ", "  5  dplyr:    , mutate, mutate_if, mutate_at, mutate_all 5.1          tidyverse   dplyr.     mutate(),           . 5.2  5.3          . 5.4  #   library(vroom) library(dplyr) #   ga_data &lt;- vroom(&quot;https://raw.githubusercontent.com/selesnow/publications/master/code_example/from_excel_to_r/lesson_3/ga_nowember.csv&quot;) # mutate # ¤   ga_data &lt;- mutate(ga_data, bounce_rate = bounces / sessions) ga_data &lt;- mutate(ga_data, bounce_rate = bounces / sessions, br_group = if_else(bounce_rate &gt; 0.6, &quot;high_br&quot;, &quot;normal_br&quot;)) # ¤      ga_data %&gt;% mutate_if(is.character, toupper) #  ¤   ¤¤ ¤ ¤ ga_data %&gt;% mutate_at(vars(matches(&quot;s$&quot;)), sqrt ) # transemute #      transmute(ga_data, bounce_rate = bounces / sessions, date = format(date, &quot;%d %B %Y&quot;), source) #       ¤   transmute_if(ga_data, is.character, toupper) 5.5  "],["-dplyr-group-by-summarise.html", " 6  dplyr:    , group_by, summarise 6.1  6.2  6.3  6.4  6.5 ", "  6  dplyr:    , group_by, summarise 6.1            ,   .        dplyr   tidyverse   group_by()  summarise().      summarise(), .. summarise(), summarise_if()  summarise_at().    : sum -  mean -   min -  max -  median -  length -  6.2  6.3          . 6.4  #   library(vroom) library(dplyr) #   ga_data &lt;- vroom(&quot;https://raw.githubusercontent.com/selesnow/publications/master/code_example/from_excel_to_r/lesson_3/ga_nowember.csv&quot;) #     ga_data %&gt;% group_by(date) %&gt;% summarise(sessions = sum(sessions), bounces = sum(bounces)) #   ga_data %&gt;% group_by(date) %&gt;% summarise_at(c(&quot;sessions&quot;, &quot;bounces&quot;), sum) #     ga_data %&gt;% group_by(date, medium) %&gt;% summarise_at(c(&quot;sessions&quot;, &quot;bounces&quot;), sum) ga_data %&gt;% group_by(date, medium) %&gt;% summarise(ses = sum(sessions), bounc = sum(bounces)) #      ga_data %&gt;% group_by(medium) %&gt;% summarise_if(is.numeric, mean) #      ndays &lt;- unique( ga_data$date ) %&gt;% length ga_data %&gt;% group_by(medium) %&gt;% summarise(daily_sessions = sum(sessions) / ndays) #      #      result &lt;- ga_data %&gt;% group_by(medium) %&gt;% summarise_if(is.numeric, list( avg = mean, med = median, sum = sum, count = length, min = min, max = max)) 6.5  "],["-dplyr-join-bind.html", " 7  dplyr:     , join, bind 7.1  7.2  7.3  7.4  7.5 ", "  7  dplyr:     , join, bind 7.1             .      UNION    SQL.    Excel     ,  SQL     JOIN.       ,       dplyr, readxl, tidyr  stringr.     : bind_rows -    left_join -    semi_join -    anti_join -    7.2  7.3          . salary.xlsx 7.4  library(readxl) library(dplyr) library(tidyr) library(stringr) ### # :        2  ### #     download.file(&quot;https://github.com/selesnow/publications/blob/master/code_example/from_excel_to_r/lesson_7/salary.xlsx?raw=true&quot;, destfile = &quot;salary.xlsx&quot;, mode = &quot;wb&quot;) #   sheets &lt;- excel_sheets(&quot;salary.xlsx&quot;) #   excel_book &lt;- sapply( sheets, read_excel, path = &quot;salary.xlsx&quot; ) #   str(excel_book) #    staff excel_book[[&#39;staff&#39;]] # ####### #    #       # ####### staff_jan &lt;- mutate(excel_book[[&#39;staff&#39;]], month = &quot;2020.01&quot;) staff_feb &lt;- mutate(excel_book[[&#39;staff&#39;]], month = &quot;2020.02&quot;) #   staff_salary &lt;- bind_rows( staff_jan, staff_feb ) #   staff_bonuses &lt;- bind_rows(excel_book[[&quot;bonus_jan&quot;]], excel_book[[&quot;bonus_feb&quot;]]) %&gt;% mutate(month = format(date, &quot;%Y.%m&quot;)) %&gt;% group_by(employee_id, month) %&gt;% summarise_at(&quot;bonus&quot;, sum) #   staff_payroll &lt;- bind_rows(excel_book[[&quot;payroll_jan&quot;]], excel_book[[&quot;payroll_feb&quot;]]) %&gt;% mutate(month = format(date, &quot;%Y.%m&quot;)) %&gt;% group_by(employee_id, month) %&gt;% summarise_at(&quot;sum&quot;, sum) # ####### #    # ####### salary_analysis &lt;- left_join(staff_salary, staff_bonuses, by = c(&quot;id&quot; = &quot;employee_id&quot;, &quot;month&quot;)) %&gt;% left_join(staff_payroll, by = c(&quot;id&quot; = &quot;employee_id&quot;, &quot;month&quot;)) %&gt;% rename(payroll = sum) %&gt;% mutate_at(c(&quot;bonus&quot;, &quot;payroll&quot;), replace_na, 0) %&gt;% mutate(total = rate + bonus - payroll) #     salary_analysis &lt;- left_join(salary_analysis, excel_book[[&#39;departmen&#39;]], by = c(&quot;departmen&quot; = &quot;id&quot;), suffix = c(&quot;_emploee&quot;, &quot;_dep&quot;)) # anti join  semi join #           semi_join(excel_book[[&#39;payroll_jan&#39;]], excel_book[[&#39;payroll_feb&#39;]], by = &quot;employee_id&quot;) %&gt;% select(employee_id) %&gt;% distinct() %&gt;% left_join(excel_book[[&#39;staff&#39;]], by = c(&quot;employee_id&quot; = &quot;id&quot;)) #           anti_join(excel_book[[&#39;payroll_jan&#39;]], excel_book[[&#39;payroll_feb&#39;]], by = &quot;employee_id&quot;) %&gt;% select(employee_id) %&gt;% distinct() %&gt;% left_join(excel_book[[&#39;staff&#39;]], by = c(&quot;employee_id&quot; = &quot;id&quot;)) #          semi_join(excel_book[[&#39;payroll_jan&#39;]], excel_book[[&#39;bonus_feb&#39;]], by = &quot;employee_id&quot;) %&gt;% select(employee_id) %&gt;% distinct() %&gt;% left_join(excel_book[[&#39;staff&#39;]], by = c(&quot;employee_id&quot; = &quot;id&quot;)) 7.5  "],["-r.html", " 8    R 8.1  8.2  8.3  8.4  8.5 ", "  8    R 8.1        ,             ,        .        dplyr,   group_by(), mutate(),    cumsum(), lag(), lead()  arrange(). 8.2  8.3          . salary_analysis.csv 8.4  library(readr) library(dplyr) #   salary &lt;- read_csv(&quot;D:\\\\Google \\\\ 20   Excel   R\\\\materials\\\\lesson_8\\\\salary_analysis.csv&quot;) #   str(salary) # ###################### #    # ###################### #      salary &lt;- salary %&gt;% group_by(departmen, month) %&gt;% mutate(total_dep = sum(total)) #          salary &lt;- salary %&gt;% mutate(staff_rate = total / total_dep) #           #    salary %&gt;% group_by(departmen, month) %&gt;% mutate(from_dep_avg = total / mean(total)) # ###################### #    # ###################### #           rating_by_dap_rate &lt;- salary %&gt;% group_by(month) %&gt;% mutate(rank = min_rank(staff_rate)) %&gt;% filter(rank == max(rank)) %&gt;% arrange(month) #         salary %&gt;% group_by(month) %&gt;% mutate(rank = dense_rank(bonus)) %&gt;% filter(rank == max(rank)) %&gt;% arrange(month) #      2019  #    salary %&gt;% filter(grepl(&quot;^2019&quot;, month)) %&gt;% #    group_by(name_dep, name_emploee) %&gt;% #      summarise(bonus = sum(bonus)) %&gt;% #   group_by(name_dep) %&gt;% #     mutate(max_bonus = max(bonus)) %&gt;% #       filter(bonus == max_bonus) #       # ###################### #    # ###################### #         salary_grow &lt;- salary %&gt;% arrange(month) %&gt;% #     group_by(id) %&gt;% #       mutate(total_grow_rate = ( total - lag(total, order_by = month) ) / total ) #   #       #    salary %&gt;% group_by(id) %&gt;% #       mutate(total_grow_rate = ( total - lag(total, order_by = month) ) / total ) %&gt;% #   group_by(month) %&gt;% filter(total_grow_rate == max(total_grow_rate, na.rm = T)) 8.5  "],["-tidyr-pivot-longer-pivot-wider.html", " 9  tidyr:         , pivot_longer, pivot_wider 9.1  9.2  9.3  9.4  9.5 ", "  9  tidyr:         , pivot_longer, pivot_wider 9.1    Excel   ,                  .            R,          .      tidyr   pivot_longer()  pivot_wider(). 9.2  9.3          . sales.xlsx shop_data_2019.csv shop_data_2020.csv 9.4  library(tidyr) library(dplyr) library(readxl) library(readr) #   #     download.file(&quot;https://github.com/selesnow/r4excel_users/blob/master/lesson_9/sales.xlsx?raw=true&quot;, destfile = &quot;sales.xlsx&quot;, mode = &quot;wb&quot;) #   data &lt;- read_excel(&#39;sales.xlsx&#39;, sheet = &#39;data&#39;) # ================== # :      #    2019  2020  # ================== #   region data &lt;- fill(data, region, .direction = &#39;down&#39;) #      data &lt;- pivot_longer( data, cols = `january 2019`:`march 2020`, names_to = &#39;month&#39;, values_to = &#39;sales&#39;) #   month     data &lt;- separate(data, col = &#39;month&#39;, into = c(&#39;month&#39;, &#39;year&#39;), remove = TRUE, sep = &quot; &quot;) #   data &lt;- data %&gt;% filter(month %in% c(&#39;january&#39;, &#39;february&#39;, &#39;march&#39;)) %&gt;% group_by(region, year) %&gt;% summarise(sales = mean(sales)) #   data %&gt;% pivot_wider(names_from = year, values_from = sales) %&gt;% mutate(grow = (`2020` - `2019`) / `2020` * 100) %&gt;% arrange(desc(grow)) #     read_excel(&#39;sales.xlsx&#39;, sheet = &#39;data&#39;) %&gt;% fill(region, .direction = &#39;down&#39;) %&gt;% pivot_longer( cols = `january 2019`:`march 2020`, names_to = &#39;month&#39;, values_to = &#39;sales&#39;) %&gt;% separate(col = &#39;month&#39;, into = c(&#39;month&#39;, &#39;year&#39;), remove = TRUE, sep = &quot; &quot;) %&gt;% filter(month %in% c(&#39;january&#39;, &#39;february&#39;, &#39;march&#39;)) %&gt;% group_by(region, year) %&gt;% summarise(sales = mean(sales)) %&gt;% pivot_wider(names_from = year, values_from = sales) %&gt;% mutate(grow = (`2020` - `2019`) / `2020` * 100) %&gt;% arrange(desc(grow)) # ############################### #  # :  %     # ############################### shop_data_2019 &lt;- read_delim( &#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_9/shop_data_2019.csv&#39;, delim = &#39;;&#39;, locale = locale(decimal_mark = &quot;,&quot;) ) #   wild_spec &lt;- build_wider_spec(shop_data_2019, names_from = &#39;key&#39;, values_from = &#39;value&#39;) #   pivot_wider_spec(shop_data_2019, spec = wild_spec) %&gt;% mutate(refund_rate = refund / ( sale + upsale )) %&gt;% arrange(desc(refund_rate)) #     shop_data_2020 &lt;- read_delim( &#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_9/shop_data_2020.csv&#39;, delim = &#39;;&#39;, locale = locale(decimal_mark = &quot;,&quot;)) #   shop_data_2020 %&gt;% pivot_wider_spec(spec = wild_spec) %&gt;% mutate(refund_rate = refund / ( sale + upsale )) %&gt;% arrange(desc(refund_rate)) #   saveRDS(object = wild_spec, file = &#39;spec.rds&#39;) #   new_wild_spec &lt;- readRDS(&#39;spec.rds&#39;) #  pivot_wider_spec(shop_data_2019, spec = new_wild_spec) %&gt;% mutate(refund_rate = refund / ( sale + upsale )) %&gt;% arrange(desc(refund_rate)) 9.5  "],["-tidyr-unnest-longer-unnest-wider.html", " 10  tidyr:    , unnest_longer, unnest_wider 10.1  10.2  10.3  10.4  10.5 ", "  10  tidyr:    , unnest_longer, unnest_wider 10.1  JSON  XML        ,  ,    .        ,         ,        .    tidyr,     tidyverse,   unnest_longer(), unnest_wider()  hoist(). 10.2  10.3          . simple.json hard_data.json 10.4  library(tidyr) library(dplyr) library(jsonlite) # ################# #  1: #  json     # 1.        #  json  staff_dict &lt;- read_json(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_10/simple.json&#39;) #  json  tibble frame staff_dict &lt;- tibble(employee = staff_dict) # 2.      #   json      #           staff_dict %&gt;% unnest_wider(employee) %&gt;% filter(bonus &gt; 0) #      staff_dict %&gt;% unnest_wider(employee) %&gt;% group_by(department) %&gt;% summarise(average_salary = mean(salary)) # ########################## #  3: #  json     #        staff_dict &lt;- read_json(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_10/hard_data.json&#39;) #  json  tibble frame staff_dict &lt;- tibble(employee = staff_dict) ##   #1 staff_dict %&gt;% unnest_wider(employee) %&gt;% select(name, department, salary, skills) %&gt;% unnest_wider(skills) %&gt;% select(name, department, salary, practics) %&gt;% unnest_longer(practics) %&gt;% group_by(name, department, salary) %&gt;% summarise(practics = paste(practics, collapse = &quot;, &quot;)) ##   #2 staff_dict %&gt;% hoist(employee, name = &quot;name&quot;, department = &quot;department&quot;, salary = &quot;salary&quot;, practics = c(&quot;skills&quot;, &quot;practics&quot;)) %&gt;% select(-employee) %&gt;% group_by(name, department, salary) %&gt;% mutate(practics = paste(unlist(practics), collapse = &quot;, &quot;)) # ########################## #  4: #  json     #   20%     R staff_dict %&gt;% hoist(employee, name = &quot;name&quot;, salary = &quot;salary&quot;, langs = c(&quot;skills&quot;, &quot;lang&quot;)) %&gt;% select(-employee) %&gt;% unnest_longer(langs) %&gt;% filter(langs == &#39;R&#39;) %&gt;% mutate(new_salary = salary * 1.2) #  5: #  json     #   30%         staff_dict %&gt;% hoist(employee, name = &quot;name&quot;, salary = &quot;salary&quot;, langs = c(&quot;skills&quot;, &quot;lang&quot;)) %&gt;% select(-employee) %&gt;% group_by(name) %&gt;% unnest_longer(langs) %&gt;% filter( ! is.na(langs) ) %&gt;% group_by( name, salary ) %&gt;% summarise( langs_num = length(langs) ) %&gt;% filter(langs_num &gt; 1) %&gt;% mutate( new_salary = salary * 1.3 ) 10.5  "],["-ggplot2-ggplot2-qplot.html", " 11  ggplot2:      ggplot2   qplot 11.1  11.2  11.3  11.4  11.5 ", "  11  ggplot2:      ggplot2   qplot 11.1          ggplot2,         .       - qplot(),    ,         R.        : -   (barplot) -   (line chart) -    (boxplot)              facet. 11.2  11.3          . sales_data.csv 11.4  # install.packages(&#39;ggplot2) library(ggplot2) library(readr) library(dplyr) library(forcats) #   sales_data &lt;- read_csv2(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_11/sales_data.csv&#39;) #      sales_data %&gt;% mutate(month = as.Date(date, &#39;%d.%m.%Y&#39;) %&gt;% format(&#39;%Y-%m&#39;)) %&gt;% group_by(month) %&gt;% count() %&gt;% qplot(data = ., x = month, y = n, fill = &#39;darkcyan&#39;, geom = &#39;col&#39;, main = &#39;  &#39;, xlab = &#39;&#39;, ylab = &#39;- &#39;) #        #      sales_data %&gt;% mutate(month = as.Date(date, &#39;%d.%m.%Y&#39;) %&gt;% format(&#39;%Y-%m&#39;)) %&gt;% group_by(month) %&gt;% count() %&gt;% qplot(data = ., x = month, y = n, fill = n, geom = &#39;col&#39;, main = &#39;  &#39;, xlab = &#39;&#39;, ylab = &#39;- &#39;) #      sales_data %&gt;% mutate(month = as.Date(date, &#39;%d.%m.%Y&#39;) %&gt;% format(&#39;%Y-%m&#39;)) %&gt;% group_by(month, shop) %&gt;% count() %&gt;% qplot(data = ., x = month, y = n, fill = shop, geom = &#39;col&#39;, group = &#39;shop&#39;, main = &#39;  &#39;, xlab = &#39;&#39;, ylab = &#39;- &#39;) #     geom #        sales_data %&gt;% mutate(month = as.Date(date, &#39;%d.%m.%Y&#39;) %&gt;% format(&#39;%Y-%m&#39;)) %&gt;% group_by(month, manager) %&gt;% summarise(sales = sum(sum)) %&gt;% qplot(data = ., x = month, y = sales, group = manager, colour = manager, geom = c(&#39;line&#39;, &#39;point&#39;), main = &#39;   &#39;, xlab = &#39;&#39;, ylab = &#39;- &#39;) # boxplot #       sales_data %&gt;% qplot(data = ., x = brand, y = price - discount, geom = &#39;boxplot&#39;, main = &#39;   &#39;, xlab = &#39;&#39;, ylab = &#39;&#39;) #    sales_data %&gt;% qplot(data = ., x = fct_reorder(.f = brand, .x = price - discount, .fun = median, .desc = T), y = price - discount, geom = &#39;boxplot&#39;, main = &#39;   &#39;, xlab = &#39;&#39;, ylab = &#39;&#39;) #     sales_data %&gt;% filter(discount &gt; 0) %&gt;% mutate(discount_rate = discount / price) %&gt;% qplot(data = ., x = fct_reorder(.f = brand, .x = discount_rate, .fun = median, .desc = T), y = discount_rate, geom = &#39;boxplot&#39;) #     sales_data %&gt;% qplot(data = ., x = sum, geom = &#39;histogram&#39;, fill = &#39;darkcyan&#39;, bins = 30, facets = shop~.) #       sales_data %&gt;% mutate(month = as.Date(date, &#39;%d.%m.%Y&#39;) %&gt;% format(&#39;%Y-%m&#39;)) %&gt;% group_by(month, manager, shop) %&gt;% count() %&gt;% qplot(data = ., x = month, y = n, fill = shop, geom = &#39;col&#39;, group = &#39;shop&#39;, facets = manager~shop, main = &#39;  ,   &#39;, xlab = &#39;&#39;, ylab = &#39;- &#39;) 11.5  "],["-ggplot2-ggplot2.html", " 12  ggplot2:       ggplot2 12.1  12.2  12.3  12.4  12.5 ", "  12  ggplot2:       ggplot2 12.1         ggplot2,       R.         ,     ggplot2.        ,         . 12.2  12.3          . sales.csv 12.4  library(ggplot2) library(dplyr) library(readr) library(forcats) #   data &lt;- read_tsv(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_12/sales.csv&#39;) #   data str(data) #   ,   data %&gt;% mutate(month = format(date, &quot;%Y-%m&quot;)) %&gt;% group_by(month) %&gt;% summarise(transactions = n_distinct(id)) %&gt;% ggplot( aes(x = month, y = transactions) ) + #   geom_col( aes( fill = transactions ), #    show.legend = FALSE) + labs(title = &quot;   2019 &quot;, #  subtitle = &quot; &quot;) + #  xlab(&quot;&quot;) + #  X ylab(&quot; &quot;) + #  y scale_fill_gradient2(low = &quot;red&quot;, #  ,   mid = &quot;gray&quot;, #   midpoint = 81.5, #     high = &quot;limegreen&quot;) #   #     #       data %&gt;% mutate(month = format(date, &quot;%Y-%m&quot;)) %&gt;% group_by(month, manager_id) %&gt;% summarise(sales_sum = sum(summ)) %&gt;% ggplot( aes(x = month, y = sales_sum, group = manager_id, colour = manager_id) ) + geom_line( size = 0.1 ) + geom_point( size = 1 ) #      data %&gt;% mutate(month = format(date, &quot;%Y-%m&quot;)) %&gt;% group_by(month, manager_id) %&gt;% summarise(sales_sum = sum(summ)) %&gt;% ggplot( aes(x = month, y = sales_sum) ) + geom_line( aes(group = manager_id, colour = manager_id) ) + geom_point( aes(group = manager_id, colour = manager_id) ) #    data %&gt;% group_by( id, shop ) %&gt;% summarise( count = sum(count) ) %&gt;% ggplot( aes(x = count) ) + geom_histogram(fill = &quot;cyan3&quot;, color = &quot;cyan4&quot;) + facet_grid( ~shop ) #   data %&gt;% group_by(id, manager_id) %&gt;% summarise(transaction_summ = sum(summ)) %&gt;% group_by(manager_id) %&gt;% summarise(avg_summ = mean(transaction_summ)) %&gt;% ggplot( aes(x = fct_reorder(.f = manager_id, .x = avg_summ, .fun = median), y = avg_summ) ) + geom_bar(aes(fill = avg_summ), show.legend = FALSE, stat = &quot;identity&quot;) + coord_flip() + #   scale_fill_gradient(low = &quot;coral1&quot;, high = &quot;limegreen&quot;) + xlab(&quot;&quot;) + ylab(&quot; &quot;) + labs(title = &quot;   2019 &quot;, #  subtitle = &quot; &quot;) 12.5  "],["-ggplot2-ggplot2-ggthemes-ggthemr.html", " 13  ggplot2:        ggplot2 (ggthemes, ggthemr) 13.1  13.2  13.3  13.4  13.5 ", "  13  ggplot2:        ggplot2 (ggthemes, ggthemr) 13.1               ggplot2,            ggthemes  ggthemr.         .        family  element_text(): sans, serif, mono. 13.2  13.3          . sales.csv 13.4  #install.packages(&#39;devtools&#39;) #devtools::install_github(&#39;cttobin/ggthemr&#39;) library(ggplot2) library(ggthemes) library(ggthemr) library(dplyr) library(readr) #   data &lt;- read_tsv(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_13/sales.csv&#39;) #  plot &lt;- #   ,   data %&gt;% mutate(month = format(date, &quot;%Y-%m&quot;)) %&gt;% group_by(month) %&gt;% summarise(transactions = n_distinct(id)) %&gt;% ggplot( aes(x = month, y = transactions) ) + #   geom_col( aes( fill = transactions) ) + #    labs(title = &quot;   2019 &quot;, #  subtitle = &quot; &quot;) + #  xlab(&quot;&quot;) + #  X ylab(&quot; &quot;) #  y #   plot + annotate(&quot;text&quot;, x = &#39;2019-05&#39;, y = 110, label = &quot;Top Sales&quot;, colour = &quot;red&quot;, size = 4, fontface = &quot;bold&quot;) #    plot + theme_stata() plot + theme_excel() plot + theme_economist() plot + theme_calc() #    ggthemr ggthemr(&#39;flat dark&#39;) plot ggthemr(&#39;flat&#39;) plot ggthemr(&#39;camoflauge&#39;) plot ggthemr(&#39;solarized&#39;) plot ggthemr_reset() #   #   ,  theme plot + theme( legend.position = &#39;none&#39;, #   title = element_text(colour = &#39;royalblue4&#39;, #  face = &#39;bold&#39;), plot.subtitle = element_text(colour = &#39;royalblue3&#39;, #  face = &#39;italic&#39;, ), axis.title = element_text(colour = &#39;gray28&#39;, #   face = &#39;bold.italic&#39;), axis.text.y = element_text(face = &#39;italic&#39;, #   y size = 7), axis.text.x = element_text(angle = 90, #   X hjust = 1, vjust = 0.5, size = 9), panel.background = element_rect(fill = &#39;skyblue1&#39;), #   panel.border = element_rect(colour = &#39;dodgerblue4&#39;, #   fill = NA), panel.grid = element_line(color = &quot;skyblue4&quot;, #   size = 0.1, linetype = &#39;dotted&#39;), plot.background = element_rect(fill = &#39;powderblue&#39;) #    ) #    theme_custom_blue &lt;- theme( legend.position = &#39;none&#39;, #   title = element_text(colour = &#39;royalblue4&#39;, #  face = &#39;bold&#39;), plot.subtitle = element_text(colour = &#39;royalblue3&#39;, #  face = &#39;italic&#39;, ), axis.title = element_text(colour = &#39;gray28&#39;, #   face = &#39;bold.italic&#39;), axis.text.y = element_text(face = &#39;italic&#39;, #   y size = 7), axis.text.x = element_text(angle = 90, #   X hjust = 1, vjust = 0.5, size = 9), panel.background = element_rect(fill = &#39;skyblue1&#39;), #   panel.border = element_rect(colour = &#39;dodgerblue4&#39;, #   fill = NA), panel.grid = element_line(color = &quot;skyblue4&quot;, #   size = 0.1, linetype = &#39;dotted&#39;), plot.background = element_rect(fill = &#39;powderblue&#39;) #    ) #    plot2 &lt;- data %&gt;% mutate(month = format(date, &quot;%Y-%m&quot;)) %&gt;% group_by(month, manager_id) %&gt;% summarise(sales_sum = sum(summ)) %&gt;% ggplot( aes(x = month, y = sales_sum, group = manager_id, colour = manager_id) ) + geom_line( size = 1 ) + geom_point( size = 1.7 ) + labs(title = &quot;  2019 &quot;, subtitle = &quot;  &quot;) #    plot2 + theme_custom_blue 13.5  "],["-solutions.html", "    (solutions)  6  7  8  9  10  11", "     (solutions)           . ..     ,          ,    ,           -   .  6  4 library(dplyr) #    set.seed(50) df &lt;- tibble(col1 = sample(c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;), size = 50, replace = TRUE), col2 = rnorm(n = 50, 5, 10), col3 = runif(n = 50, 15, 50), col4 = sample(letters, 50, TRUE), col5 = sample(LETTERS, 50, TRUE)) #  df %&gt;% group_by(col1) %&gt;% #  summarise(avg = mean(col2)) %&gt;% #   filter(col1 == &#39;b&#39;) %&gt;% #     select(avg) #     7  3 #     library(dplyr) set.seed(50) xdf &lt;- tibble(xkey = sample(c(&quot;a&quot;, &quot;c&quot;, &quot;d&quot;), size = 150, replace = TRUE), count = sample(2:10, 150, TRUE)) ydf &lt;- tibble(xcode = c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;), name = c(&quot;banan&quot;, &quot;apple&quot;, &quot;orange&quot;, &quot;kiwi&quot;, &quot;cherry&quot;), price = c(4.3, 2.1, 3.3, 4.7, 3.7)) #  left_join( xdf, ydf, by = c(&quot;xkey&quot; = &quot;xcode&quot;) ) %&gt;% mutate( sum = count * price ) %&gt;% group_by(name) %&gt;% summarise(total = sum(sum)) %&gt;% filter(name == &quot;kiwi&quot;)  8  2 library(dplyr) #       set.seed(50) df &lt;- tibble(step = rep(1:60, 2), group = c(rep(&quot;A&quot;, 60), rep(&quot;B&quot;, 60)), val = round(runif(120, 100, 1000), 0)) %&gt;% arrange(step) #       #        run res &lt;- df %&gt;% group_by(group) %&gt;% mutate(run = cumsum(val)) #             res %&gt;% filter( step %in% c(4, 32, 18) &amp; group == &quot;A&quot; | step %in% c(10, 48, 51) &amp; group == &quot;B&quot;) %&gt;% arrange( group, step ) %&gt;% .$run %&gt;% cat  3 library(dplyr) #       set.seed(50) df &lt;- tibble(step = rep(1:60, 2), group = c(rep(&quot;A&quot;, 60), rep(&quot;B&quot;, 60)), val = round(runif(120, 100, 1000), 0)) %&gt;% arrange(step) #  df %&gt;% group_by(group) %&gt;% mutate(growth = val - lag(val)) %&gt;% summarise(avg_growth = mean(growth, na.rm=TRUE)) %&gt;% filter(group == &quot;B&quot;) %&gt;% select(avg_growth)  9  2 library(dplyr) library(tidyr) set.seed(50) df &lt;- tibble(shop = c(&quot;starMarket&quot;, &quot;euroshop&quot;, &quot;wowsales&quot;), jan = runif(3, 10000, 25000), feb = runif(3, 10000, 25000), mar = runif(3, 10000, 25000), apr = runif(3, 10000, 25000), may = runif(3, 10000, 25000), jun = runif(3, 10000, 25000), jul = runif(3, 10000, 25000), aug = runif(3, 10000, 25000), sep = runif(3, 10000, 25000), oct = runif(3, 10000, 25000), nov = runif(3, 10000, 25000), dec = runif(3, 10000, 25000)) #  df %&gt;% pivot_longer( jan:dec, names_to = &#39;month&#39;, values_to = &quot;sales&quot; ) %&gt;% group_by(shop) %&gt;% summarise(sales = sum(sales)) %&gt;% slice_max(sales) %&gt;% select(shop)  4 library(dplyr) library(tidyr) set.seed(50) df &lt;- tibble(name = c(rep(&#39;Alex&#39;, 3), rep(&#39;John&#39;, 3), rep(&#39;Tom&#39;, 3)), key = rep(c(&quot;sale&quot;, &#39;refund&#39;, &#39;discount&#39;), 3), val = c(runif(1, 1000, 2000), runif(1, 100, 250), runif(1, 50, 150), runif(1, 1000, 2000), runif(1, 100, 250), runif(1, 50, 150), runif(1, 1000, 2000), runif(1, 100, 250), runif(1, 50, 150))) #  df %&gt;% pivot_wider( names_from = key, values_from = val ) %&gt;% mutate( total_sum = sale - refund - discount ) %&gt;% slice_max(total_sum) %&gt;% select(name, total_sum)  10  2 library(jsonlite) library(tidyr) library(dplyr) json &lt;- read_json(path = &#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/test/t10-1.json&#39;) #  json &lt;- tibble(json = json) json %&gt;% unnest_wider(json) %&gt;% group_by(department) %&gt;% summarise(avgage = mean(age)) %&gt;% filter(department == &quot;IT&quot;) %&gt;% select(avgage)  3 library(jsonlite) library(tidyr) library(dplyr) json &lt;- read_json(path = &#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/test/t10-2.json&#39;) #  data &lt;- tibble(data = json) # c   data %&gt;% unnest_longer(data) %&gt;% unnest_wider(data) %&gt;% select(square) %&gt;% unlist %&gt;% mean  4 library(jsonlite) library(tidyr) library(dplyr) json &lt;- read_json(path = &#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/test/t10-2.json&#39;) #  data &lt;- tibble(data = json) data %&gt;% unnest_longer(data) %&gt;% unnest_wider(data) %&gt;% unnest_longer(schedule) %&gt;% select(data_id, schedule_id, schedule) %&gt;% filter( schedule_id == &#39;sun&#39; &amp; schedule == 0) %&gt;% select(data_id)  5 library(tidyr) library(dplyr) library(readr) library(stringr) data &lt;- read.csv(&quot;https://raw.githubusercontent.com/selesnow/r4excel_users/master/test/production_calendar.csv&quot;) #  data %&gt;% pivot_longer(January:December, names_to = &quot;month&quot;, values_to = &quot;days&quot;) %&gt;% mutate(days = str_split(days, &quot;,&quot;)) %&gt;% unnest_longer(days) %&gt;% filter( Year %in% c(2005, 2008, 2012, 2017) &amp; str_detect(days, &quot;\\\\*&quot;) ) %&gt;% nrow  11  2 library(readr) library(ggplot2) library(dplyr) sales_data &lt;- read_csv2(&#39;https://raw.githubusercontent.com/selesnow/r4excel_users/master/lesson_11/sales_data.csv&#39;) #  sales_data %&gt;% group_by(shop, brand) %&gt;% summarise(count = sum(count)) %&gt;% qplot(data = ., x = brand, y = count, fill = brand, geom = &#39;col&#39;, facets = ~ shop) "]]
